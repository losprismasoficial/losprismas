const API_KEY = "gen-lang-client-0004483447"; 

    async function sendMessage() {
        const input = document.getElementById('userInput');
        const container = document.getElementById('chat-container');
        if (!input.value) return;

        const userText = input.value;
        container.innerHTML += `<div class="user-msg">${userText}</div>`;
        input.value = "";
        
        // El Oráculo de Los Prismas
        const promptSagrado = `Actúa como el Guardián de Los Prismas. 
        Tus leyes: 1. Papel 120-160 g/m2. 2. Impresión escala 100%, doble faz, borde largo. 
        3. Mantra: "No es para pintar perfecto. Es para dejar marcas". 
        Pregunta del usuario: ${userText}`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: promptSagrado }] }]
                })
            });

            const data = await response.json();
            
            if (data.error) {
                console.error("Error de la API:", data.error.message);
                throw new Error(data.error.message);
            }

            const botText = data.candidates[0].content.parts[0].text;
            container.innerHTML += `<div class="bot-msg">${botText}</div>`;
            container.scrollTop = container.scrollHeight;
        } catch (e) {
            container.innerHTML += `<div class="bot-msg" style="color: #ff5555;">El Prisma no responde. Revisa si tu API Key en AI Studio tiene restricciones de IP o si está activa.</div>`;
        }
    }
